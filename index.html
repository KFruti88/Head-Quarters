<!DOCTYPE html>
<html>
<head>
    <title>618 Tactical Command</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #ccc; font-family: sans-serif; }
        .farm1-text { color: #FF5F00; } /* Jet-Orange */
        .farm2-text { color: #C41E3A; } /* Cardinal Red */
        .card { background: #111; border: 1px solid #333; padding: 15px; margin-bottom: 20px; }
        .section-title { border-bottom: 2px solid #444; margin-bottom: 10px; font-weight: bold; text-transform: uppercase; }
    </style>
</head>
<body class="p-4">
    <h1 class="text-4xl font-black text-center mb-8 italic">TACTICAL INTELLIGENCE CENTER</h1>

    <div class="grid grid-cols-2 gap-8">
        <div id="farm1-container">
            <h2 class="text-5xl font-black farm1-text mb-4 uppercase">FARM 01</h2>
            <div id="f1-content">
                <div class="card"><div class="section-title farm1-text">Balance</div><div id="f1-money" class="text-4xl">$0</div></div>
                <div class="card"><div class="section-title farm1-text">Fleet & Damage</div><div id="f1-fleet" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm1-text">Livestock & Feed</div><div id="f1-animals" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm1-text">Factories & Production</div><div id="f1-factories" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm1-text">Trophies</div><div id="f1-trophies" class="space-y-2"></div></div>
            </div>
        </div>

        <div id="farm2-container">
            <h2 class="text-5xl font-black farm2-text mb-4 uppercase">FARM 02</h2>
            <div id="f2-content">
                <div class="card"><div class="section-title farm2-text">Balance</div><div id="f2-money" class="text-4xl">$0</div></div>
                <div class="card"><div class="section-title farm2-text">Fleet & Damage</div><div id="f2-fleet" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm2-text">Livestock & Feed</div><div id="f2-animals" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm2-text">Factories & Production</div><div id="f2-factories" class="space-y-2"></div></div>
                <div class="card"><div class="section-title farm2-text">Trophies</div><div id="f2-trophies" class="space-y-2"></div></div>
            </div>
        </div>
    </div>

    <script>
        async function runTacticalReport() {
            const ts = new Date().getTime();
            const getXml = async (f) => {
                const r = await fetch(`${f}?v=${ts}`);
                const t = await r.text();
                return new DOMParser().parseFromString(t, "text/xml");
            };

            try {
                const [farms, vehicles, placeables, career] = await Promise.all([
                    getXml('farms.xml'), getXml('vehicles.xml'), getXml('placeables.xml'), getXml('careerSavegame.xml')
                ]);

                // 1. BALANCES (from farms.xml)
                Array.from(farms.getElementsByTagName("farm")).forEach(f => {
                    const id = f.getAttribute("farmId");
                    const money = parseInt(f.getAttribute("money")).toLocaleString();
                    if(document.getElementById(`f${id}-money`)) document.getElementById(`f${id}-money`).innerText = `$${money}`;
                });

                // 2. FLEET (from vehicles.xml) - Damage & Fuel
                Array.from(vehicles.getElementsByTagName("vehicle")).forEach(v => {
                    const fId = v.getAttribute("farmId");
                    const name = v.getAttribute("filename").split('/').pop().split('.')[0];
                    const dmg = (parseFloat(v.querySelector("component")?.getAttribute("damage") || 0) * 100).toFixed(0);
                    const fuel = v.querySelector("consumer[type='fuel']")?.getAttribute("usage") || "0";
                    
                    const html = `<div class="border-b border-gray-800 pb-1"><strong>${name}</strong><br>Damage: ${dmg}% | Fuel: ${Math.round(fuel)}L</div>`;
                    if(document.getElementById(`f${fId}-fleet`)) document.getElementById(`f${fId}-fleet`).innerHTML += html;
                });

                // 3. ANIMALS (from placeables.xml)
                Array.from(placeables.getElementsByTagName("placeable")).forEach(p => {
                    const fId = p.getAttribute("farmId");
                    const animalType = p.getAttribute("templateName");
                    if (animalType && animalType.includes("Barn")) {
                        const health = p.querySelector("animal")?.getAttribute("health") || "100";
                        const html = `<div><strong>${animalType}</strong>: Health ${health}%</div>`;
                        if(document.getElementById(`f${fId}-animals`)) document.getElementById(`f${fId}-animals`).innerHTML += html;
                    }
                });

            } catch (e) { console.error("Report Error:", e); }
        }
        runTacticalReport();
    </script>
</body>
</html>
