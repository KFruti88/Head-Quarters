<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>618 Tactical Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap');
        :root { --f1: #FF5F00; --f2: #C41E3A; --f0: #444444; --glass: rgba(15, 15, 15, 0.85); }
        body { background: radial-gradient(circle at top right, #1a1a1a, #000); color: #ccc; font-family: 'JetBrains Mono', monospace; font-size: 11px; min-height: 100vh; }
        .glass-panel { background: var(--glass); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8); }
        .f1-text { color: var(--f1); text-shadow: 0 0 8px rgba(255, 95, 0, 0.4); }
        .f1-border { border-color: var(--f1); }
        .f2-text { color: var(--f2); text-shadow: 0 0 8px rgba(196, 30, 58, 0.4); }
        .f2-border { border-color: var(--f2); }
        .header-box { padding: 12px; min-width: 250px; }
        .scroll-box { height: 400px; overflow-y: auto; padding: 15px; background: rgba(0, 0, 0, 0.4); }
        .card-inner { background: rgba(255, 255, 255, 0.03); padding: 10px; margin-bottom: 10px; border-radius: 4px; border-left: 4px solid; }
        .hud-bar-bg { background: #222; height: 6px; border-radius: 3px; margin-top: 6px; overflow: hidden; border: 1px solid #333; }
        .fuel-fill { background: #3b82f6; height: 100%; }
        .dmg-fill { background: #ef4444; height: 100%; }
        .trophy-fill { background: #22c55e; height: 100%; }
        .trophy-earned { border-left-color: #22c55e !important; background: rgba(34, 197, 94, 0.05); opacity: 0.5; }
        ::-webkit-scrollbar { width: 4px; } ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); }
    </style>
</head>
<body class="p-8">

    <header class="flex justify-between items-start mb-10 border-b border-gray-800 pb-8">
        <div class="flex flex-col">
            <b class="text-4xl text-white uppercase font-black italic tracking-tighter">618 TACTICAL</b>
            <span class="text-xs text-blue-400 font-bold tracking-widest uppercase">Operational Status: Secure</span>
        </div>

        <div class="flex gap-6">
            <div class="header-box glass-panel f1-border">
                <div class="f1-text font-black text-xs uppercase">F1: FUNNY FARMS (Werewolf)</div>
                <div class="text-white text-3xl font-black" id="f1-head-money">$0</div>
                <div id="time-gnv" class="text-[10px] text-gray-400 font-bold mt-1">ET: --:--</div>
                <div id="weather-gnv" class="text-[10px] text-gray-500 uppercase">WEATHER: --</div>
            </div>
            <div class="header-box glass-panel f2-border">
                <div class="f2-text font-black text-xs uppercase">F2: DUMBBELL'S FARM (Ray)</div>
                <div class="text-white text-3xl font-black" id="f2-head-money">$0</div>
                <div id="time-flora" class="text-[10px] text-gray-400 font-bold mt-1">CT: --:--</div>
                <div id="weather-flora" class="text-[10px] text-gray-500 uppercase">WEATHER: --</div>
            </div>
            <div class="header-box glass-panel border-blue-500 p-3 min-w-[150px]">
                <div class="text-blue-400 font-black text-xs uppercase tracking-widest">Game Sync</div>
                <div id="game-time" class="text-white text-3xl font-black">00:00</div>
                <div id="game-date" class="text-[10px] text-gray-400 font-bold italic uppercase">--</div>
            </div>
        </div>
        <div class="text-right">
            <div class="text-gray-500 text-xs font-bold uppercase">Map Collectibles</div>
            <div class="text-5xl font-black text-yellow-500"><span id="coll-found">0</span>/50</div>
        </div>
    </header>

    <div class="grid grid-cols-4 gap-6 mb-8">
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase text-center">F1 Trophies</h3><div id="f1-trophies" class="scroll-box"></div></div>
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase text-center">F1 Production</h3><div id="f1-prod" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase text-center">F2 Trophies</h3><div id="f2-trophies" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase text-center">F2 Production</h3><div id="f2-prod" class="scroll-box"></div></div>
    </div>

    <div class="grid grid-cols-4 gap-6 mb-8">
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase">F1 Fleet</h3><div id="f1-fleet" class="scroll-box"></div></div>
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase">F1 Attach</h3><div id="f1-attach" class="scroll-box"></div></div>
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase">F1 Pallets</h3><div id="f1-pallets" class="scroll-box"></div></div>
        <div class="glass-panel f1-border"><h3 class="f1-text font-bold p-3 border-b border-gray-800 uppercase">F1 Fields</h3><div id="f1-fields" class="scroll-box"></div></div>
    </div>

    <div class="grid grid-cols-4 gap-6 mb-8">
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase">F2 Fleet</h3><div id="f2-fleet" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase">F2 Attach</h3><div id="f2-attach" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase">F2 Pallets</h3><div id="f2-pallets" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-bold p-3 border-b border-gray-800 uppercase">F2 Fields</h3><div id="f2-fields" class="scroll-box"></div></div>
    </div>

    <div class="grid grid-cols-3 gap-6 mb-8">
        <div class="glass-panel border-gray-700"><h3 class="text-white font-bold p-3 border-b border-gray-800 uppercase">Active Missions</h3><div id="missions" class="scroll-box"></div></div>
        <div class="glass-panel border-gray-700"><h3 class="text-yellow-600 font-bold p-3 border-b border-gray-800 uppercase">Market Stocks</h3><div id="stocks" class="scroll-box"></div></div>
        <div class="glass-panel border-purple-800"><h3 class="text-purple-500 font-bold p-3 border-b border-gray-800 uppercase">Collectible Locator</h3><div id="all-coll" class="scroll-box"></div></div>
    </div>

    <div class="grid grid-cols-2 gap-6 mb-8">
        <div class="glass-panel f1-border"><h3 class="f1-text font-black p-4 uppercase">Funny Farms Livestock</h3><div id="f1-animals" class="scroll-box"></div></div>
        <div class="glass-panel f2-border"><h3 class="f2-text font-black p-4 uppercase">Dumbbell Livestock</h3><div id="f2-animals" class="scroll-box"></div></div>
    </div>

    <div class="mt-12 border-t border-gray-800 pt-8">
        <h2 class="text-gray-600 font-black mb-4 uppercase text-center italic">Global Uplink (Farm 0)</h2>
        <div class="grid grid-cols-4 gap-6">
            <div class="glass-panel border-gray-800"><h3 class="text-gray-500 font-bold p-3 border-b border-gray-800 uppercase">System Fleet</h3><div id="f0-fleet" class="scroll-box opacity-40"></div></div>
            <div class="glass-panel border-gray-800"><h3 class="text-gray-500 font-bold p-3 border-b border-gray-800 uppercase">System Assets</h3><div id="f0-prod" class="scroll-box opacity-40"></div></div>
            <div class="glass-panel border-gray-800"><h3 class="text-gray-500 font-bold p-3 border-b border-gray-800 uppercase">NPC Land</h3><div id="f0-fields" class="scroll-box opacity-40"></div></div>
            <div class="glass-panel border-blue-900"><h3 class="text-blue-500 font-bold p-3 border-b border-gray-800 uppercase">Active Mods</h3><div id="active-mods" class="scroll-box"></div></div>
        </div>
    </div>

    <script>
        const fillLabels = { 'SOUPCANSBEETROOT': 'Beetroot Soup', 'BEETROOT': 'Beetroot', 'SOUPCANSPOTATO': 'Potato Soup', 'POTATO': 'Potato', 'SOUPCANSCARROTS': 'Carrot Soup', 'CARROT': 'Carrot', 'TMR': 'TMR', 'SILAGE': 'Silage', 'DRYGRASS_WINDROW': 'Hay', 'GRASS_WINDROW': 'Grass', 'MILK': 'Milk', 'LIQUIDMANURE': 'Slurry', 'MANURE': 'Manure', 'EGG': 'Eggs' };
        function cleanLabel(raw) { return fillLabels[raw] || raw; }

        const masterTrophyList = [
            { id: "nature", name: "Farming is in our nature", desc: "Plant today - harvest tomorrow." },
            { id: "road", name: "Road Trip", desc: "That thing wouldn't have fit onto the street anyway." },
            { id: "plant", name: "Plant get enough", desc: "A little help can go a long way." },
            { id: "thickens", name: "The plot thickens", desc: "Reached maximum efficiency." },
            { id: "hopp", name: "Allez hopp", desc: "Oh, they can do THAT as well?" },
            { id: "kangaroo", name: "You are not a kangaroo", desc: "Seriously, think of the poor animal!" },
            { id: "giddy", name: "Giddy-up!", desc: "I could get used to getting around like this…" },
            { id: "thorough", name: "Thoroughbred!", desc: "I'm a real cowboy, mom!" },
            { id: "help", name: "Help me to help you", desc: "Sure, I can take care of that, neighbour." },
            { id: "helper", name: "Helper A does not stop", desc: "What do you mean 'take care of my own farm'?" },
            { id: "beginning", name: "It's just the beginning", desc: "I've never felt happier than here." },
            { id: "sprinkle", name: "Just a sprinkle", desc: "You have to think about the future." },
            { id: "sow", name: "It's sow easy", desc: "Planting one bean will yield much green." },
            { id: "own", name: "Own use", desc: "Reap what you sow." },
            { id: "supplier", name: "Large-scale supplier", desc: "Fruits of your labour." },
            { id: "field", name: "Field Trip", desc: "One vehicle for all of your needs." },
            { id: "haul", name: "Long haul", desc: "In it for the long game, I see." },
            { id: "gogh", name: "van Gogh", desc: "Look at Mr. Fancypants over there." },
            { id: "fell", name: "It just fell off", desc: "Only a matter of time…" },
            { id: "fix", name: "Fix me up", desc: "Consider a membership card." },
            { id: "fluff", name: "Fluffiness", desc: "Building up my wool empire." },
            { id: "piggies", name: "Three little piggies…", desc: "Food they need." },
            { id: "clucky", name: "Clucky Streak", desc: "Now that's a lot of Easter eggs." },
            { id: "honey", name: "Bringing in the Honey", desc: "Busy bee." },
            { id: "cowherd", name: "Cowherd", desc: "Bet you didn't think they'd be that much work." },
            { id: "switch", name: "I like to switch it up", desc: "We're slowly getting there." },
            { id: "weekend", name: "Weekend vehicle", desc: "I need each and every one." },
            { id: "fleet", name: "Vehicle fleet", desc: "I might have a problem…" },
            { id: "shakespeare", name: "Shakespeare and stuff", desc: "First step." },
            { id: "cultivated", name: "Highly cultivated", desc: "Proud of this one." },
            { id: "paw", name: "Ultimutt Pawesomeness", desc: "Who's a good boy?" },
            { id: "wrap", name: "That's a wrap", desc: "What's in the bale?" },
            { id: "cotton", name: "Gone but not for cotton", desc: "Where would you even store them?!" },
            { id: "raisin", name: "Raisin the stakes", desc: "Californian gold!" },
            { id: "olea", name: "Olea europaea", desc: "Fruit, not vegetable!" },
            { id: "grain", name: "Original grain", desc: "Horses crazy for it." },
            { id: "rock", name: "Rock on", desc: "Paved with rocks." },
            { id: "wood", name: "You wood not believe it", desc: "Leaf of absence." },
            { id: "stumped", name: "I'm stumped", desc: "Does one hand clap?" },
            { id: "hard", name: "Hard work pays off", desc: "Spend it, right?" },
            { id: "land", name: "All out of Land", desc: "Everything is mine." },
            { id: "machine", name: "Well-Oiled Machine", desc: "Franchise this…" },
            { id: "colourful", name: "Pretty colourful", desc: "Childhood memories." },
            { id: "gameon", name: "Game on", desc: "Collector myself." },
            { id: "cheese", name: "Cheese it", desc: "Fondue?" },
            { id: "late", name: "Never too late", desc: "It feels good to be home." }
        ];

        const werewolfStats = {
            help: 100, paw: 100, giddy: 100, hopp: 100, machine: 100, land: 100, wood: 100, stumped: 100,
            weekend: 90, switch: 60, cowherd: 45, fleet: 45, kangaroo: 36, clucky: 31, beginning: 10, helper: 8, field: 7, thorough: 4, shakespeare: 4, road: 2
        };

        const rayEarned = ["road", "plant", "hopp", "kangaroo", "giddy", "thorough", "help", "beginning", "own", "switch", "weekend", "fleet", "shakespeare", "paw", "wrap", "hard", "land", "machine", "colourful"];

        function updateClocks() {
            const now = new Date();
            document.getElementById('time-gnv').innerText = `ET: ` + now.toLocaleTimeString('en-US', { timeZone: 'America/New_York', hour: '2-digit', minute: '2-digit' });
            document.getElementById('time-flora').innerText = `CT: ` + now.toLocaleTimeString('en-US', { timeZone: 'America/Chicago', hour: '2-digit', minute: '2-digit' });
        }

        async function getRealWeather() {
            try {
                const gnv = await fetch('https://api.open-meteo.com/v1/forecast?latitude=29.65&longitude=-82.32&current_weather=true&temperature_unit=fahrenheit').then(r => r.json());
                const flora = await fetch('https://api.open-meteo.com/v1/forecast?latitude=38.67&longitude=-88.49&current_weather=true&temperature_unit=fahrenheit').then(r => r.json());
                document.getElementById('weather-gnv').innerText = `TEMP: ${Math.round(gnv.current_weather.temperature)}°F | SUNNY`;
                document.getElementById('weather-flora').innerText = `TEMP: ${Math.round(flora.current_weather.temperature)}°F | SUNNY`;
            } catch(e) {}
        }

        async function updateDashboard() {
            const ts = new Date().getTime();
            const fetchXml = async (f) => { try { const r = await fetch(`${f}?v=${ts}`); return r.ok ? new DOMParser().parseFromString(await r.text(), "text/xml") : null; } catch(e) { return null; } };
            const [farms, vehicles, placeables, career, farmland] = await Promise.all([ fetchXml('farms.xml'), fetchXml('vehicles.xml'), fetchXml('placeables.xml'), fetchXml('careerSavegame.xml'), fetchXml('farmland.xml') ]);

            if(farms && career) {
                const globalMoney = Math.floor(parseFloat(career.querySelector("statistics money")?.textContent || 0));
                let farm2Money = 0;
                Array.from(farms.getElementsByTagName("farm")).forEach(f => {
                    if(f.getAttribute("farmId") == "2") farm2Money = Math.floor(parseFloat(f.getAttribute("money") || 0));
                });
                document.getElementById(`f2-head-money`).innerText = "$" + farm2Money.toLocaleString();
                document.getElementById(`f1-head-money`).innerText = "$" + (globalMoney - farm2Money).toLocaleString();
                document.getElementById("game-time").innerText = career.querySelector("dayTime")?.textContent || "00:00";
                const day = career.querySelector("gameRuntime")?.textContent || "0";
                document.getElementById("game-date").innerText = `Runtime: ${Math.floor(day/3600)} Hours`;
                const fStr = career.querySelector("map foundHelpIcons")?.textContent || "";
                document.getElementById('coll-found').innerText = (fStr.split('1').length - 1);

                // MODS LIST LOGIC
                const modsBox = document.getElementById('active-mods');
                modsBox.innerHTML = "";
                Array.from(career.getElementsByTagName("mod")).forEach(m => {
                    const title = m.getAttribute("title") || m.getAttribute("modName");
                    const version = m.getAttribute("version") || "v1.0";
                    modsBox.innerHTML += `<div class="card-inner border-blue-900"><b>${title.toUpperCase()}</b><br><span class="text-gray-500 text-[9px]">${version}</span></div>`;
                });
            }

            renderSortedTrophies('f1-trophies', werewolfStats, null, 'f1-border');
            renderSortedTrophies('f2-trophies', null, rayEarned, 'f2-border');

            ['f1-fleet','f2-fleet','f0-fleet','f1-attach','f2-attach','f1-animals','f2-animals','f1-prod','f2-prod','f0-prod','f1-fields','f2-fields','f0-fields','all-coll'].forEach(id => { if(document.getElementById(id)) document.getElementById(id).innerHTML = ""; });
            
            if(vehicles) {
                Array.from(vehicles.getElementsByTagName("vehicle")).forEach(v => {
                    const fId = v.getAttribute("farmId");
                    const path = v.getAttribute("filename");
                    const name = path.split('/').pop().replace('.xml','').replace(/_/g, ' ').toUpperCase();
                    const fuel = Math.round(v.querySelector("consumer[type='fuel']")?.getAttribute("usage") || 0);
                    const dmg = (parseFloat(v.querySelector("component")?.getAttribute("damage") || 0) * 100).toFixed(1);
                    let target = (fId == "1" || fId == "2") ? (fuel > 0 ? `f${fId}-fleet` : `f${fId}-attach`) : "f0-fleet";
                    if(document.getElementById(target)) document.getElementById(target).innerHTML += `<div class="card-inner ${fId=='0'?'border-gray-800':(fId=='1'?'f1-border':'f2-border')}"><b>${name}</b><br>FUEL: ${fuel}L | DMG: ${dmg}%<div class="hud-bar-bg"><div class="fuel-fill" style="width:${Math.min(100,(fuel/400)*100)}%"></div><div class="dmg-fill" style="width:${dmg}%"></div></div></div>`;
                });
            }

            if(placeables) {
                Array.from(placeables.getElementsByTagName("placeable")).forEach(p => {
                    const fId = p.getAttribute("farmId");
                    const storage = p.querySelector("storage");
                    if(!storage) return;
                    const displayName = p.getAttribute("customName") || p.getAttribute("templateName") || p.getAttribute("filename").split('/').pop().replace('.xml','').replace(/_/g, ' ');
                    let target = (fId == "1" || fId == "2") ? (p.getElementsByTagName("animal").length > 0 ? `f${fId}-animals` : `f${fId}-prod`) : "f0-prod";
                    let h = `<div class="card-inner ${fId=='1'?'f1-border':(fId=='2'?'f2-border':'border-gray-800')}"><b>${displayName.toUpperCase()}</b><br>`;
                    Array.from(storage.getElementsByTagName("node")).forEach(node => {
                        const lvl = Math.round(parseFloat(node.getAttribute("fillLevel")));
                        if(lvl > 1) h += `<div class="flex justify-between border-b border-gray-900 mt-1"><span>${cleanLabel(node.getAttribute("fillType"))}</span><span>${lvl.toLocaleString()}L</span></div>`;
                    });
                    if(document.getElementById(target)) document.getElementById(target).innerHTML += h + "</div>";
                });
            }

            if(farmland) {
                Array.from(farmland.getElementsByTagName("land")).forEach(l => {
                    const fId = l.getAttribute("farmId");
                    let target = (fId == "1" || fId == "2") ? `f${fId}-fields` : "f0-fields";
                    if(document.getElementById(target)) document.getElementById(target).innerHTML += `<div class="card-inner ${fId=='1'?'f1-border':(fId=='2'?'f2-border':'border-gray-800')}"><b>FIELD ${l.getAttribute("id")}</b></div>`;
                });
            }
        }

        function renderSortedTrophies(containerId, stats, earnedList, farmColorClass) {
            const container = document.getElementById(containerId);
            container.innerHTML = "";
            const list = masterTrophyList.map(t => {
                let prog = earnedList ? (earnedList.includes(t.id) ? 100 : 0) : (stats[t.id] || 0);
                return { ...t, prog };
            });
            list.sort((a, b) => {
                if (a.prog === 100 && b.prog < 100) return 1;
                if (a.prog < 100 && b.prog === 100) return -1;
                return b.prog - a.prog;
            });
            list.forEach(t => {
                const isDone = t.prog === 100;
                container.innerHTML += `<div class="card-inner ${farmColorClass} ${isDone ? 'trophy-earned' : ''}"><div class="flex justify-between"><b>${t.name}</b> <span class="font-bold">${t.prog}%</span></div><div class="text-[9px] text-gray-500 italic">${t.desc}</div><div class="hud-bar-bg"><div class="trophy-fill" style="width:${t.prog}%"></div></div></div>`;
            });
        }

        updateClocks(); setInterval(updateClocks, 1000); 
        getRealWeather(); setInterval(getRealWeather, 600000); 
        updateDashboard();
    </script>
</body>
</html>
