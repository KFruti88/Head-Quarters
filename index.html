<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>618 Tactical - Live Vault</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: white; }
        .card { background-color: #1e293b; border: 1px solid #334155; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="max-w-md w-full p-6 card rounded-xl shadow-2xl">
        <h1 class="text-2xl font-bold text-center mb-6 text-blue-400">618 TACTICAL VAULT</h1>
        
        <div class="space-y-4">
            <div class="p-4 rounded-lg bg-slate-800">
                <p class="text-sm text-slate-400 uppercase tracking-wider">Available Funds</p>
                <p id="vault-money" class="text-3xl font-mono text-green-400">Loading...</p>
            </div>

            <div class="p-4 rounded-lg bg-slate-800">
                <p class="text-sm text-slate-400 uppercase tracking-wider">Server Age</p>
                <p id="vault-hours" class="text-3xl font-mono text-blue-300">Loading...</p>
            </div>
        </div>

        <div class="mt-6 text-center">
            <p id="last-update" class="text-xs text-slate-500 italic">Syncing with G-Portal...</p>
        </div>
    </div>

    <script>
        async function fetchVaultData() {
            try {
                // Fetch the XML file (cache-busting added)
                const response = await fetch('live_vault.xml?v=' + new Date().getTime());
                if (!response.ok) throw new Error('Network response was not ok');
                
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, "text/xml");

                // --- FS22 XML TARGETING ---
                // Money is located in <statistics><money>
                const moneyElement = xmlDoc.getElementsByTagName("money")[0];
                const moneyValue = moneyElement ? parseInt(moneyElement.textContent) : 0;

                // Playtime is in minutes in <statistics><playTime>
                const playTimeElement = xmlDoc.getElementsByTagName("playTime")[0];
                const minutes = playTimeElement ? parseInt(playTimeElement.textContent) : 0;
                const hours = Math.floor(minutes / 60);

                // Update the UI
                document.getElementById('vault-money').innerText = "$" + moneyValue.toLocaleString();
                document.getElementById('vault-hours').innerText = hours + " Hours";
                document.getElementById('last-update').innerText = "Last Updated: " + new Date().toLocaleTimeString();

            } catch (error) {
                console.error("Failed to load vault:", error);
                document.getElementById('vault-money').innerText = "Error";
                document.getElementById('vault-hours').innerText = "Offline";
            }
        }

        // Run once on load
        fetchVaultData();
        // Refresh every 5 minutes while the page is open
        setInterval(fetchVaultData, 300000);
    </script>
</body>
</html>
